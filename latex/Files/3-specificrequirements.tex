\section{Requirements}
\label{sect:Specificrequirements}

\subsection{Functional requirements}
\label{subsect:functionalrequirements}

\begin{description}
    \item [G1] Allow manager to sign on the system
        \begin{enumerate}[label=\textbf{R\arabic*}]
            \item A shop owner must be able to begin the sign on process.
            \item The system must require the shop owner to provide all the credentials needed.
            \item The system must check that the credentials don't belong to another account already registered to the system.
            \item The system must verify the email provided by the shop owner sending an unique code to the address and requesting it from the registration interface.
            \item The system must verify the phone number provided by the shop owner by sending an unique code via SMS and requesting it from the registration interface.
            \item The system must verify the credentials through PEC API.
            \item When the sign on process is completed and the informations provided have been verified by the system, a new account must have been produced.
        \end{enumerate}
    \item [G2] Allow a manager to sign in the system
        \begin{enumerate}[resume*]
            \item The manager must be able to begin the sign in process.
            \item The system must require the manager to insert email address and password to authenticate.
            \item The system must be check if the credentials inserted match an existing account.
            \item The system must present to the manager a solution to reset forgotten credentials.
            \item The system may allow only managers who provide the corrects pairs of emails and password to sign in.
        \end{enumerate}
    \item [G3] Allow a manager to register their store/stores on the system
        \begin{enumerate}[resume*]
            \item The manager must be able to begin the process of registering a store.
            \item The system must require the manager to provide the address of the shop.
            \item The system must require the manager to provide the schedule of the shop.
            \item The system must require the manager to provide the opening days of the shop.
            \item The system must require the manager to provide the name of the shop.
            \item The system must require the manager to provide the maximum number of people allowed in the shop.
            \item The manager can optionally provide to the system a subdivision of the shop in areas with a maximum number of people allowed in each area.
            \item The manager can optionally provide to the system the items that are sold in each area.
            \item The system must verify the validity of the data received from the manager through the PEC system (?). TODO: non so come dire che deve verificare con le cose PEC qua...
            \item The system must comunicate the result of the process to the manager.
        \end{enumerate}
    \item [G4] Allow a manager to update their shops informations and settings
        \begin{enumerate}[resume*]
            \item The manager must be able to begin the process of updating the store informations.
            \item The system must require the manager to select the information to update.
            \item The system must require the manager to update the information selected.
            \item The system must update the information.
            \item The system must comunicate the result of the process to the manager. 
        \end{enumerate}
    \item [G5] Allow a manager to check the general status and the statistic of their shops
        \begin{enumerate}[resume*]
            \item The manager must be able to begin the process of checking the status of an owned shop.
            \item The system must be able to retrieve the informations about the number of people currently in the shop.
            \item The system must be able to retrieve the informations about the number of people enqueued.
            \item The system must be able to retrieve the informations about the estimated total duration of the queue.
            \item The system must be able to retrieve the informations about all of the shopping session booked with the attached information of when they will happen and how long they will last.
            \item The system must be able to retrieve the informations about the medium time of permanence in the shop. 
            \item The system must be able to retrieve the informations about the medium time of wait in the queue.
            \item The system must be able to retrieve the informations about the medium number of people enqueued at a given hour.
            \item The system must be able to retrieve the informations about the medium number of people inside the shop at a given hour.
            \item The system must present to the manager the information retrieved.
        \end{enumerate}
    \item [G6] Allow a manager to cancel a previously booked shopping session for a customer %TODO: controlla che anche nei goal ci sia scritto customer e non user !!!
        \begin{enumerate}[resume*]
            \item The manager must be able to begin the process of canceling a previously booked shopping session for an user.
            \item The system must be able to retrieve the shopping session booked in his shops.
            \item The system must require the manager to identify the shopping session to cancel.
            \item At the end of the process the system must inform the manager of the result of the process.
        \end{enumerate}
    \item [G7] Allow a user to sign on the system
        \begin{enumerate}[resume*]
            \item The user must be able to begin the sign on process.
            \item The system must require the user to provide all the credentials needed.
            \item The system must check that the credentials don't belong to another account already registered to the system.
            \item The system must verify the email provided by the user sending an unique code to the address and requesting it from the registration interface.
            \item The system must verify the phone number provided by the user by sending an unique code via SMS and requesting it from the registration interface.
            \item When the sign on process is completed and the informations provided have been verified by the system, a new account must have been produced.
        \end{enumerate}
    \item [G8] Allow a user to sign in the system
        \begin{enumerate}[resume*]
            \item The user must be able to begin the sign in process.
            \item The system must require the user to insert email address and password to authenticate.
            \item The system must be check if the credentials inserted match an existing account.
            \item The system must present to the user a solution to reset forgotten credentials.
            \item The system may allow only users who provide the corrects pairs of emails and password to log in.
        \end{enumerate}
    \item [G] TODO: non so neanche se questo goal c'è... allow a user to search a shop
        \begin{enumerate}[resume*]
            \item The user must be able to begin the process of searching a shop.
            \item If the user provides his GPS position to the system, the system must be able to ask the user a radius and to retrieve all the shop within that area.
            \item The system must be able to ask the user a keyword to search a shop.
            \item The system must be able to retrieve all the shops matching the inserted keyword.
            \item The system must be able to present to the user the shops found in a map or in a list.
            \item The user must be able to select a shop from the ones provided by the system.
            \item The system must be able to retrieve general informations of the selected shop and to display them to the user.
        \end{enumerate}
    \item [G9] Allow a user to join the virtual queue
        \begin{enumerate}[resume*]
            \item After searching a shop, the user must be able to begin the process of joining the virtual queue of a shop.
            \item The system must be able to understand if an enqueuement is possible or if it’s demand must be rejected, and the system must display this information to the user.
            \item The system must be able to estimate the queue duration and display this information to the user.
            \item The system must require the user to provide the approximate duration of the shopping session and must check if is valid.
            \item If the user provides his GPS position to the system, the system must be able to ask to the user by what means he it is going to go to the shop and to retrieve the estimated time using Google Maps API. Also the system must be able to send to the user a notification 5 minutes before the estimated time to get to the shop.
            \item The system must be able to notificate the user with the awaiting time.
        \end{enumerate}
    \item [G10] Allow a customer to join a virtual queue from the spot
        \begin{enumerate}[resume*]
            \item The system must be able to display through the totem the general informations of the shop.
            \item After approaching the totem, the customer must be able to begin the process of joining the virutal queue of the shop.
            \item The system must be able to estimate the queue duration and display this information to the customer.
            \item The system must be able to insert the permanence time and the system must check if it is possible.
            \item The system must be able to book an anonymous visit for the user at the exact time of end of the estimated duration of the queue.
            \item The system must be able to create a QR-code that refers to the booked visit.
            \item The system must be able to print a ticket with all the relevant information: shop, time, date and QR-code.
        \end{enumerate}
    \item [G11] Allow a user to book a shopping session at a grocery store
        \begin{enumerate}[resume*]
            \item After searching a shop, the user must be able to begin the process of booking an online session process.
            \item If the user provides his GPS position to the system, the system must be able to ask to the user by what means he is going to go to the shop and to retrieve the estimated time using Google Maps API. Also the system must be able to send to the user a notification 5 minutes before the estimated time to get to the shop.
            \item The system must require the user to provide the date and the hour in which the shopping session will began.
            \item The system must require the user to provide the approximate duration of the shopping session.
            \item The system must be able to optionally ask the user what categories they are interested in.
            \item The system must be able to optionally ask the user what items they are interested in.
            \item if a queue exists, the system must ensure that the first available booking session for the user to select will start at least after the awaiting time of the queue.
        \end{enumerate}
    \item [G12] Allow a user to retrieve informations about his previously booked visits
        \begin{enumerate}[resume*]
            \item The system must allow the user to begin the process of checking the booked sessions.
            \item The system must be able to retrieve the booked session of an user.
            \item The system must present to the user the booked visits categorized in active and inactive.
            \item The user must be able to select one of the booked visists presented.
            \item The system must be able to retrieve all the informations about a booked visit and display it to the user.
        \end{enumerate}
    \item [G13] Allaw a user to retrieve informations about current enqueuements
        \begin{enumerate}[resume*]
            \item The system must allow the user to begin the process of retrieving informations about current enqueuements, only if the user is currently enqueued.
            \item The system must retrieve all the informations about the user's queue and display it to the user.
        \end{enumerate}
    \item [G14] Allow a user to retrieve informations about shops 
        \begin{enumerate}[resume*]
            \item After searching a shop, the user must be able to begin the process of retrieving more informations about a shop.
            \item The system must be able to retrieve all the informations about a shop and display them to the user.
        \end{enumerate}
    \item [G15] Allow a users and customers to enter and exit stores with QR codes
        \begin{enumerate}[resume*]
            \item The system must be able to correctly scan a QR-code.
            \item The system must be able to check the validity of the QR-code.
            \item The system must be able to interact with the turnstile enabling or disabling it.
        \end{enumerate}
    \item [G16] Allow a user to exit a previously joined queue
        \begin{enumerate}[resume*]
            \item The user must be able to begin the process of exiting a previously joined queue, only if the user is currently enqueued.
            \item The system must be able to correctly remove the user from the queue.
            \item The system must be able to correctly confirm the result of the operation to the user.
        \end{enumerate}
    \item [G17] Allow customers to line up TODO: ??? è uguale a G10... aspettiamo la push di ludo
        \begin{enumerate}[resume*]
            \item 
        \end{enumerate}
    \item [G18] Allow a customer to cancel a previously booked visit TODO: qua la chiamiamo booked visit e sopra lo chiamiamo enqueuement.. dobbiamo fare chiarezza sui termini.
        \begin{enumerate}[resume*]
            \item The customer must be able to begin the process of canceling a previously booked visit. TODO: stessa cosa del termine nel goal
            \item The system must allow the user to enter a code in the totem to cancel his booked visit.
            \item The system must be able to correctly remove the booked visit.
            \item The system must be able to correctly confirm the result of the operation to the user.
        \end{enumerate}
    \item [G19] Allow a user to cancel a previously booked visit
        \begin{enumerate}[resume*]
            \item The user must be able to begin the process of canceling a previously booked visit, only if the user currently has an active visit booked.
            \item The system must be able to correctly cancel a booked visit.
            \item The system must be able to correctly confirm the success of the operation to the user.
        \end{enumerate}
\end{description}

%TODO: what abaout multiple enqueuement (precondition of requirements)?? and what about overlapping visits? we have not specified anything about it! Also only one reservation in one shop.

%//TODO: non so dove mettere questo todo.. comunque il problema a cui pensavo è il fatto che può darsi che tipo a qualcuno si scarichi il telefono durante la spesa e quindi non possa uscire dal negozio siccome non ha più il QR code, dovremmo fare in modo che il manager possa farli uscire con dei QR code speciali, o meglio che possa reperire i QR code di una persona che lo richiede. Basterebbe fare che i QR code sono legati alla persona e fine dei problemi...
%
%\subsubsection{TODO: su google doc c'è "Allow a user to check the congestion of the shop, ma non lo abbiamo come goal...}
%\label{subsubsect:TODO}
%
%\begin{itemize}[topsep=0pt]
%    \item the user must be able to begin the process of checking the congestion of the shop
%    \item the system must be able to retrieve the position of the user from the GPS
%    \item the system must be able to retrieve the position of the shops close to the position of the user within a ray of a default distance (settable by the user) of 5 km using the GPS
%    \item the system must be able to retrieve a shop, if such shop exists, using the GPS  and GMAPS API using the input given by the user ( IE THE NAME OF THE SHOP OR THE ADDRESS )
%    \item the user must be able to select a shop from the ones provided by the system
%    \item the system must be able to retrieve to the user the number of people present in the shop in the moment in which the check is requested
%\end{itemize}
%
%\textbf{Domain assumptions}: [D7], [D1], [D5], [D3], [D4].
%
%\subsubsection{TODO: su google doc c'è "Allow a user to check the status of queue for a given shop", ma non lo abbiamo come goal...}
%\label{subsubsect:TODO}
%
%\begin{itemize}[topsep=0pt]
%    \item the user must be able to begin the process of checking the queue of a given shop
%    \item the system must be able to retrieve the position of the user from the GPS
%    \item the system must be able to retrieve the position of the shops close to the position of the user within a ray of a default distance (settable by the user) of 5 km using the GPS
%    \item the system must be able to retrieve a shop, if such shop exists, using the GPS  and GMAPS API using the input given by the user ( IE THE NAME OF THE SHOP OR THE ADDRESS )
%    \item the user must be able to select a shop from the ones provided by the system
%    \item the system must be able to retrieve to the user the number of people present in the queue for the shop they selected
%\end{itemize}
%
% TODO: parlare dei QR-code: sono personali di un account, gli unici anonimi sono quelli generati dai totem. 
% se così bisogna aggiungere i requirements all'iscrizione di un utente:
% \item the system must generate a QR-code releted to the user
% Oppure no..? in caso bisogna aggiungere i seguenti requirements ai goals G9 (user enqueeu) e G11 (user book a visit)
% \item The system must be able to generate a QR-code related to the (enqueuement/shopping sessione) and display it to the user
%
\subsection{Non functional requirements}
\label{subsect:softwaresystemattributes}

\subsubsection{Availability and accessibility}
\label{subsubsect:availabilityandaccessibility}

Since the service we are providing is intended to completely replace any current method used, the system must be always available, avoiding as much as possible down-times. Very small deviations from this requirement will be obviously acceptable.

In addition to the availability, we want to ensure accessibility to the largest variety of people possible: every person should be able to interact with our service. To ensure this property, we deliver different products: the ones who can access an internet connection and a smarthphone can easily entry the system through the mobile app or the web app, and the ones who doesn't have a smarthphone can also use the web app from a computer, for those who doesn't have neither a smartphone nor a computer there is the possibility to use one of the totems placed at the entrance of a stores.

Also all the hardware and the software will be built with regards to all of those people with disabilities, ensuring an easy navigation through the interfaces.

\subsubsection{Security}
\label{subsubsect:security}

The most critical data our application will handle is the users credential. Handling this aspect is one of our main secuirty concern, making sure any third party or malicious actors will never come across. 

Also the application will work with metadata about users, such as position, enqueuements, booked visits, items they are willing to buy, and so on. Our purpose is to store only the strictly necessary information in order to have the functions of the application work; anything else will be converted in anonymous data, in order to create general statistics, or discarded.

We must provide security to shops owners too, ensuring that their virtual shops will not be attacked. One of the major thread we need to face is the fact that a large amount of people can make shops unavilable by creating huge queues and booking all the possible visits on purpose. In the first release of the system, this issue will not be covered, but we'll develope the application so that counter measures can be implemented easily in the future releases.

\subsubsection{Scalability}
\label{subsubsect:scalability}

The complexity of our system won't increase linearly with the growth of its reach since every shop will be mainly managed separately.
Thanks to this, scalability will just be a matter of increasing computational resources. 

Also, since the first release of the system is not going to be a final release, we'll produce the software so that extra features can be embodied easily. An example of future feature may be something that is missing and we have not considered, or discarded on purpose to better focus on main functions, such as the nice feature "enqueue with a friend", which will provide different people with their own smartphones with differents ticket to enter the shop at the same time. A gamified system is also planned for developement in order to encourage a correct behaviour while using the app, such as getting to the shop in time or using the cancelling featutures as less as possible.

\subsubsection{Accuracy}
\label{subsubsect:accuracy}

CLup system will handle different types of informations, and each one requires different degrees of accuracy:
\begin{itemize}[topsep=0pt]
    \item \textit{Informations about shops}: the more precise the better it is. Since we are not the ones providing these informations we cannot ensure the precision, but this task is left to the shops managers.
    \item \textit{Informations about position}: all the informations about user's position are not needed to make our application work, but only to have some extra features. Obviously the most accurate the better, but since it is not essential, there isn't a limit required.
\end{itemize}